before-aft test race condit provides-util function function test test testing-python code fn